"use strict";(()=>{var e={};e.id=4461,e.ids=[4461],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},33958:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>d,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>i,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l});var n={};t.r(n),t.d(n,{GET:()=>c});var a=t(42429),o=t(13227),u=t(20279),s=t(77586);async function c(e){let{searchParams:r}=new URL(e.url),t=r.get("password"),n=(0,s.I)(t);return n?Response.json({password:n},{status:200}):Response.json({error:"Invalid password"},{status:400})}let i=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/decryption/route",pathname:"/api/auth/decryption",filename:"route",bundlePath:"app/api/auth/decryption/route"},resolvedPagePath:"D:\\SCHINKELS\\repo\\SAFWA-BIZ-PROCESS\\src\\app\\api\\auth\\decryption\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:l,serverHooks:p}=i,d="/api/auth/decryption/route";function y(){return(0,u.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:l})}},59957:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Fernet=void 0;let n=t(18195);class a{constructor(e){this.key=e,a.checkKey(this.key)}static checkKey(e){try{let r=(0,n.fromBase64Url)(e);if(32!==r.length)throw Error("Key must be 32-byte long base64url encoded string.")}catch(e){throw Error("Key must be 32-byte long base64url encoded string.")}}static generateKey(){return(0,n.toBase64Url)((0,n.randomBytes)(32))}encrypt(e){return a.encrypt(e,this.key)}decrypt(e){return a.decrypt(e,this.key)}static decrypt(e,r){try{a.checkKey(r);let t=(0,n.fromBase64Url)(r),o=t.subarray(0,16),u=t.subarray(16,32),s=(0,n.fromBase64Url)(e);if(s.length<73||(s.length-57)%16!=0)throw Error("Fernet token has invalid length.");let c=s.subarray(0,1);if(!(0,n.compareBuffers)(c,a.version))throw Error("Fernet version must be 0x80");s.subarray(1,9);let i=s.subarray(9,25),f=s.subarray(25,s.length-32),l=s.subarray(s.length-32,s.length),p=s.subarray(0,s.length-32),d=(0,n.computeHmac)(p,o);if(!(0,n.compareBuffers)(l,d))throw Error("Invalid signature. Signature did not match digest.");return(0,n.aesDecrypt)(f,u,i).toString("utf-8")}catch(e){throw e}}static encrypt(e,r){try{a.checkKey(r);let t=(0,n.fromBase64Url)(r),o=t.subarray(0,16),u=t.subarray(16,32),s=a.version,c=(0,n.ts8byteBuffer)(),i=(0,n.generateIv)(),f=(0,n.aesEncrypt)(e,u,i),l=Buffer.concat([s,c,i,f]),p=(0,n.computeHmac)(l,o),d=Buffer.concat([s,c,i,f,p]);return(0,n.toBase64Url)(d)}catch(e){throw e}}static deriveKey(e){let r=Buffer.from(e,"utf-8"),t=(0,n.hash)(r,"sha256");return(0,n.toBase64Url)(t)}}r.Fernet=a,a.version=Buffer.from([128])},41511:(e,r,t)=>{r.p=void 0;var n=t(59957);Object.defineProperty(r,"p",{enumerable:!0,get:function(){return n.Fernet}})},75450:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fromBase64Url=r.toBase64Url=void 0,r.toBase64Url=e=>{let r=e.toString("base64url"),t=r.length%4,n=r.length-t===r.length?r.length:r.length+(4-t);return r.padEnd(n,"=")},r.fromBase64Url=e=>{let r=e.replace(/\=/g,"");if(Buffer.from(r,"base64url").toString("base64url")!==r)throw Error("Invalid encoding. String must be base64url encoded string.");return Buffer.from(r,"base64url")}},87534:function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var a=Object.getOwnPropertyDescriptor(r,t);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,a)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),a=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(r,e,t);return a(r,e),r};Object.defineProperty(r,"__esModule",{value:!0}),r.hash=r.compareBuffers=r.computeHmac=r.aesDecrypt=r.aesEncrypt=r.generateIv=r.randomBytes=void 0;let u=o(t(6113)),s=e=>u.randomBytes(e);r.randomBytes=s,r.generateIv=()=>s(16),r.aesEncrypt=(e,r,t,n="aes-128-cbc")=>{let a=u.createCipheriv(n,r,t),o=a.update(e,"utf8","hex");return o+=a.final("hex"),Buffer.from(o,"hex")},r.aesDecrypt=(e,r,t,n="aes-128-cbc")=>{let a=u.createDecipheriv(n,r,t),o=a.update(e);return Buffer.concat([o,a.final()])},r.computeHmac=(e,r,t="sha256")=>u.createHmac(t,r).update(e).digest(),r.compareBuffers=(e,r)=>u.timingSafeEqual(e,r),r.hash=(e,r="sha256")=>u.createHash(r).update(e).digest()},18195:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ts8byteBuffer=r.randomBytes=r.hash=r.generateIv=r.computeHmac=r.compareBuffers=r.aesEncrypt=r.aesDecrypt=r.toBase64Url=r.fromBase64Url=void 0;var n=t(75450);Object.defineProperty(r,"fromBase64Url",{enumerable:!0,get:function(){return n.fromBase64Url}}),Object.defineProperty(r,"toBase64Url",{enumerable:!0,get:function(){return n.toBase64Url}});var a=t(87534);Object.defineProperty(r,"aesDecrypt",{enumerable:!0,get:function(){return a.aesDecrypt}}),Object.defineProperty(r,"aesEncrypt",{enumerable:!0,get:function(){return a.aesEncrypt}}),Object.defineProperty(r,"compareBuffers",{enumerable:!0,get:function(){return a.compareBuffers}}),Object.defineProperty(r,"computeHmac",{enumerable:!0,get:function(){return a.computeHmac}}),Object.defineProperty(r,"generateIv",{enumerable:!0,get:function(){return a.generateIv}}),Object.defineProperty(r,"hash",{enumerable:!0,get:function(){return a.hash}}),Object.defineProperty(r,"randomBytes",{enumerable:!0,get:function(){return a.randomBytes}});var o=t(3342);Object.defineProperty(r,"ts8byteBuffer",{enumerable:!0,get:function(){return o.ts8byteBuffer}})},3342:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ts8byteBuffer=void 0,r.ts8byteBuffer=()=>{let e=Math.trunc(Date.now()/1e3),r=Buffer.alloc(8,0);return r.writeUInt32BE(e,4),r}},42429:(e,r,t)=>{e.exports=t(30517)},77586:(e,r,t)=>{t.d(r,{I:()=>a});var n=t(41511);let a=(e,r)=>(r=r||process.env.FERNET_KEY,n.p.decrypt(e,r))}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8290],()=>t(33958));module.exports=n})();